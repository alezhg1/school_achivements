<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="csrf-token" content="{{ csrf_token }}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è - –ú–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 444</title>
  <style>
    /* –°–ë–†–û–° –°–¢–ò–õ–ï–ô */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      background: white;
      font-family: "Segoe UI", Roboto, -apple-system, BlinkMacSystemFont, Arial, sans-serif;
      font-size: 13px;
      line-height: 1.3;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É –Ω–∞ –≤—Å–µ–º —Å–∞–π—Ç–µ */
    }

    /* HEADER */
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: linear-gradient(90deg, #0077e6 0%, #005bb5 100%);
      color: #fff;
      z-index: 1200;
      box-shadow: 0 3px 8px rgba(3, 36, 74, 0.12);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 10px 12px;
      width: 100%;
      height: 55px;
    }

    .logo a {
      font-weight: 700;
      font-size: 1rem;
      color: #fff;
      text-decoration: none;
      white-space: nowrap;
    }

    nav {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: flex-end;
      flex: 1;
    }

    nav a {
      color: rgba(255, 255, 255, 0.95);
      text-decoration: none;
      padding: 5px 7px;
      border-radius: 5px;
      font-weight: 600;
      transition: all 0.22s;
      font-size: 0.8rem;
      white-space: nowrap;
    }

    nav a:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-1px);
    }

    .logout-btn {
      background: rgba(220, 53, 69, 0.9);
      color: white;
      padding: 5px 8px;
      border-radius: 5px;
      text-decoration: none;
      font-weight: 600;
      font-size: 0.75rem;
      border: none;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.3s ease;
      margin-left: 5px;
    }

    .logout-btn:hover {
      background: #dc3545;
      transform: translateY(-1px);
    }

    /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ */
    .main-content {
      display: flex;
      justify-content: center;
      align-items: center;
      height: calc(100vh - 55px);
      margin-top: 55px;
      box-sizing: border-box;
      padding: 15px;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    /* –ö–û–ù–¢–ï–ô–ù–ï–† –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò */
    .register-container {
      display: grid;
      grid-template-columns: 0.5fr 1.5fr;
      gap: 20px;
      max-width: 800px;
      width: 100%;
      animation: fadeIn 0.5s ease;
      align-self: center;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    /* –õ–µ–≤—ã–π –±–ª–æ–∫ */
    .auth-info-card {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border: 1px solid #dee2e6;
      color: #333;
      padding: 20px 15px;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 15px;
      text-align: center;
      height: auto;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    .auth-header h1 {
      font-size: 1.4rem;
      margin: 0;
      font-weight: 800;
      line-height: 1.2;
      color: #003366;
    }

    .platform-icon {
      font-size: 2rem;
      margin: 8px auto;
    }

    .platform-title {
      font-size: 1rem;
      font-weight: 600;
      color: #007bff;
      margin: 0;
    }

    .brief-description p {
      font-size: 0.75rem;
      color: #666;
      line-height: 1.3;
      margin: 0;
    }

    /* –°—Å—ã–ª–∫–∞ –Ω–∞ –≤—Ö–æ–¥ */
    .auth-switch {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid #dee2e6;
    }

    .auth-switch p {
      color: #666;
      font-size: 0.75rem;
      margin: 0 0 6px 0;
    }

    .switch-link {
      display: inline-block;
      background: #007bff;
      color: white;
      padding: 6px 12px;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 600;
      font-size: 0.75rem;
      transition: all 0.3s ease;
    }

    .switch-link:hover {
      background: #0056b3;
      transform: translateY(-2px);
    }

    /* –ü—Ä–∞–≤—ã–π –±–ª–æ–∫ - –§–æ—Ä–º–∞ */
    .auth-form-card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.06);
      border: 1px solid #e9ecef;
      height: auto;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    .auth-form {
      display: flex;
      flex-direction: column;
      gap: 15px;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π */
    .teacher-notice {
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      color: #0d47a1;
      padding: 8px 10px;
      border-radius: 6px;
      border: 1px solid #90caf9;
      margin-bottom: 10px;
    }

    .teacher-notice.hidden {
      display: none;
    }

    .notice-header {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .notice-icon {
      font-size: 1rem;
    }

    .notice-header div {
      flex: 1;
    }

    .notice-header strong {
      display: block;
      font-size: 0.8rem;
      margin-bottom: 1px;
    }

    .notice-header p {
      margin: 0;
      font-size: 0.7rem;
      opacity: 0.9;
    }

    /* –°–µ–∫—Ü–∏–∏ —Ñ–æ—Ä–º—ã */
    .form-section {
      display: flex;
      flex-direction: column;
      gap: 8px;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    .form-section h3 {
      color: #003366;
      margin: 0;
      font-size: 0.9rem;
      font-weight: 600;
    }

    /* –í—ã–±–æ—Ä —Ä–æ–ª–∏ */
    .role-selection {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    .role-card {
      position: relative;
      cursor: pointer;
    }

    .role-card input[type="radio"] {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }

    .role-card-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      padding: 12px 8px;
      border: 1.5px solid #e8f4ff;
      border-radius: 8px;
      background: white;
      transition: all 0.3s ease;
      text-align: center;
    }

    .role-card input[type="radio"]:checked + .role-card-content,
    .role-card.active .role-card-content {
      background: #007bff;
      color: white;
      border-color: #007bff;
      box-shadow: 0 2px 6px rgba(0, 123, 255, 0.15);
      transform: translateY(-1px);
    }

    .role-card:hover .role-card-content {
      border-color: #007bff;
      transform: translateY(-1px);
    }

    .role-icon {
      font-size: 1.3rem;
    }

    .role-title {
      font-weight: 600;
      font-size: 0.8rem;
    }

    /* –°–µ—Ç–∫–∞ —Ñ–æ—Ä–º—ã */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    .form-row {
      display: flex;
      gap: 10px;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    .form-row .form-group {
      flex: 1;
    }

    /* –ì—Ä—É–ø–ø—ã —Ñ–æ—Ä–º—ã */
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    .form-group label {
      font-weight: 600;
      color: #003366;
      font-size: 0.75rem;
    }

    .auth-form input:not([type="checkbox"]),
    .auth-form select {
      width: 100%;
      padding: 8px 10px;
      border: 1.5px solid #e8f4ff;
      border-radius: 6px;
      background: #f9fcff;
      font-size: 0.8rem;
      transition: all 0.3s ease;
      font-family: inherit;
    }

    .auth-form input:focus,
    .auth-form select:focus {
      border-color: #007bff;
      box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.1);
      outline: none;
      background: white;
    }

    .error-field {
      border-color: #dc3545 !important;
    }

    .email-hint small {
      color: #007bff;
      font-size: 0.65rem;
    }

    /* –ß–µ–∫–±–æ–∫—Å */
    .checkbox-group {
      display: flex;
      align-items: flex-start;
      gap: 6px;
      overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    }

    .checkbox-group input[type="checkbox"] {
      width: 12px;
      height: 12px;
      margin-top: 1px;
    }

    .checkbox-label {
      font-size: 0.75rem;
      color: #333;
      line-height: 1.2;
      cursor: pointer;
    }

    .checkbox-label a {
      color: #007bff;
      font-weight: 600;
    }

    /* –ö–Ω–æ–ø–∫–∞ */
    .btn-primary {
      background: linear-gradient(135deg, #007bff, #0047b3);
      color: white;
      border: none;
      padding: 10px;
      font-weight: 600;
      border-radius: 7px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.85rem;
      margin-top: 5px;
      width: 100%;
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3);
    }

    .btn-primary:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

    /* –û—à–∏–±–∫–∏ */
    .alert {
      padding: 8px 10px;
      border-radius: 6px;
      margin-bottom: 10px;
    }

    .alert-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .field-errors {
      margin-top: 2px;
    }

    .error {
      color: #dc3545;
      font-size: 0.65rem;
      display: block;
    }

    /* –§—É—Ç–µ—Ä —Ñ–æ—Ä–º—ã */
    .auth-footer {
      text-align: center;
      margin-top: 10px;
      color: #666;
      font-size: 0.7rem;
    }

    .auth-footer a {
      color: #007bff;
      font-weight: 600;
      text-decoration: none;
    }

    .auth-footer a:hover {
      text-decoration: underline;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .hidden {
      display: none !important;
    }

    /* –î–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
    @media (max-width: 768px) {
      .register-container {
        grid-template-columns: 1fr;
        max-width: 95%;
        gap: 15px;
      }
      
      .auth-info-card {
        padding: 15px 12px;
        display: none;
      }
      
      .auth-form-card {
        padding: 15px;
      }
    }
  </style>
</head>
<body>
  <!-- –•–µ–¥–µ—Ä –∫–∞–∫ –≤ base.html -->
  <header>
    <div class="logo">
      <a href="/">–ú–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</a>
    </div>

    <nav>
      {% if user.is_authenticated %}
        <a href="{% url 'dashboard' %}">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="{% url 'profile' user.username %}">–ü—Ä–æ—Ñ–∏–ª—å</a>
        <a href="{% url 'logout' %}" class="logout-btn">–í—ã–π—Ç–∏</a>
      {% else %}
        <a href="{% url 'login' %}">–í–æ–π—Ç–∏</a>
        <a href="{% url 'register' %}" class="logout-btn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
      {% endif %}
    </nav>
  </header>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <div class="main-content">
    <div class="register-container">
      
      <!-- –õ–µ–≤—ã–π –±–ª–æ–∫ -->
      <div class="auth-info-card">
        <div class="auth-header">
          <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
          <div class="platform-icon">üéØ</div>
          <p class="platform-title">–ú–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 444</p>
        </div>

        <div class="brief-description">
          <p>–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</p>
        </div>

        <div class="auth-switch">
          <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç?</p>
          <a href="{% url 'login' %}" class="switch-link">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</a>
        </div>
      </div>

      <!-- –ü—Ä–∞–≤—ã–π –±–ª–æ–∫ - –§–æ—Ä–º–∞ -->
      <div class="auth-form-card">
        <form method="post" class="auth-form" id="registerForm" novalidate>
          {% csrf_token %}

          <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π -->
          <div class="teacher-notice hidden" id="teacherNotice">
            <div class="notice-header">
              <span class="notice-icon">üë®‚Äçüè´</span>
              <div>
                <strong>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—á–∏—Ç–µ–ª—è</strong>
                <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∫–æ–ª—å–Ω—ã–π email @schmos444.ru</p>
              </div>
            </div>
          </div>

          <!-- –í—ã–≤–æ–¥ –æ–±—â–∏—Ö –æ—à–∏–±–æ–∫ -->
          {% if form.non_field_errors %}
            <div class="alert alert-error">
              {% for error in form.non_field_errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}

          <!-- –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
          <div class="form-section">
            <h3>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å *</h3>
            <div class="role-selection">
              <label class="role-card {% if form.role.value == 'student' or not form.role.value %}active{% endif %}">
                <input type="radio" name="role" value="student" {% if form.role.value == 'student' or not form.role.value %}checked{% endif %}>
                <div class="role-card-content">
                  <span class="role-icon">üë®‚Äçüéì</span>
                  <span class="role-title">–£—á–µ–Ω–∏–∫</span>
                </div>
              </label>
              
              <label class="role-card {% if form.role.value == 'teacher' %}active{% endif %}">
                <input type="radio" name="role" value="teacher" {% if form.role.value == 'teacher' %}checked{% endif %}>
                <div class="role-card-content">
                  <span class="role-icon">üë®‚Äçüè´</span>
                  <span class="role-title">–£—á–∏—Ç–µ–ª—å</span>
                </div>
              </label>
            </div>
          </div>

          <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
          <div class="form-section">
            <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="id_username">–õ–æ–≥–∏–Ω *</label>
                <input type="text" name="username" id="id_username" 
                       value="{{ form.username.value|default:'' }}" 
                       placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω" required>
              </div>

              <div class="form-group">
                <label for="id_email">Email *</label>
                <input type="email" name="email" id="id_email" 
                       value="{{ form.email.value|default:'' }}" 
                       placeholder="your@email.com" required>
                <div class="email-hint hidden" id="teacherEmailHint">
                  <small>–î–ª—è —É—á–∏—Ç–µ–ª–µ–π: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ @schmos444.ru</small>
                </div>
              </div>

              <div class="form-group">
                <label for="id_first_name">–ò–º—è</label>
                <input type="text" name="first_name" id="id_first_name" 
                       value="{{ form.first_name.value|default:'' }}" 
                       placeholder="–í–∞—à–µ –∏–º—è">
              </div>

              <div class="form-group">
                <label for="id_last_name">–§–∞–º–∏–ª–∏—è</label>
                <input type="text" name="last_name" id="id_last_name" 
                       value="{{ form.last_name.value|default:'' }}" 
                       placeholder="–í–∞—à–∞ —Ñ–∞–º–∏–ª–∏—è">
              </div>
            </div>
          </div>

          <!-- –ö–ª–∞—Å—Å (—Ç–æ–ª—å–∫–æ –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤) -->
          <div class="form-section student-fields {% if form.role.value == 'teacher' %}hidden{% endif %}" id="studentFields">
            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∞—Å—Å–µ *</h3>
            <div class="form-row">
              <div class="form-group">
                <label for="id_class_number">–ù–æ–º–µ—Ä –∫–ª–∞—Å—Å–∞</label>
                <input type="text" name="class_number" id="id_class_number" 
                       value="{{ form.class_number.value|default:'' }}" 
                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5" required>
              </div>
              
              <div class="form-group">
                <label for="id_class_letter">–ë—É–∫–≤–∞ –∫–ª–∞—Å—Å–∞</label>
                <input type="text" name="class_letter" id="id_class_letter" 
                       value="{{ form.class_letter.value|default:'' }}" 
                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê" required>
              </div>
            </div>
          </div>

          <!-- –ü–∞—Ä–æ–ª–∏ -->
          <div class="form-section">
            <h3>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
            <div class="form-row">
              <div class="form-group">
                <label for="id_password1">–ü–∞—Ä–æ–ª—å *</label>
                <input type="password" name="password1" id="id_password1" 
                       placeholder="–ù–µ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤" required>
              </div>
              
              <div class="form-group">
                <label for="id_password2">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å *</label>
                <input type="password" name="password2" id="id_password2" 
                       placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
              </div>
            </div>
          </div>

          <!-- –°–æ–≥–ª–∞—à–µ–Ω–∏–µ -->
          <div class="form-section">
            <div class="checkbox-group">
              <input type="checkbox" name="accept_policy" 
                     id="id_accept_policy" 
                     {% if form.accept_policy.value %}checked{% endif %} required>
              <label for="id_accept_policy" class="checkbox-label">
                –Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å <a href="#" style="color: #007bff; text-decoration: none;">–ø–æ–ª–∏—Ç–∏–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</a> *
              </label>
            </div>
          </div>

          <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
          <button type="submit" class="btn-primary" id="submitBtn">
            <span class="btn-text">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</span>
            <span class="btn-loading" style="display: none;">‚è≥ –°–æ–∑–¥–∞–µ–º –∞–∫–∫–∞—É–Ω—Ç...</span>
          </button>

          <div class="auth-footer">
            –ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã? <a href="#">–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</a>
          </div>
        </form>
      </div>

    </div>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('registerForm');
    const submitBtn = document.getElementById('submitBtn');
    const roleCards = document.querySelectorAll('.role-card');
    const studentFields = document.getElementById('studentFields');
    const teacherNotice = document.getElementById('teacherNotice');
    const teacherEmailHint = document.getElementById('teacherEmailHint');
    const emailInput = document.getElementById('id_email');
    const studentClassNumber = document.getElementById('id_class_number');
    const studentClassLetter = document.getElementById('id_class_letter');

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π
    roleCards.forEach(card => {
      const radio = card.querySelector('input[type="radio"]');

      radio.addEventListener('change', function() {
        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å
        roleCards.forEach(c => c.classList.remove('active'));
        card.classList.add('active');

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª—è –∫–ª–∞—Å—Å–∞
        if (this.value === 'student') {
          studentFields.classList.remove('hidden');
          teacherNotice.classList.add('hidden');
          teacherEmailHint.classList.add('hidden');

          // –î–µ–ª–∞–µ–º –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤
          studentClassNumber.required = true;
          studentClassLetter.required = true;

          // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É email
          emailInput.placeholder = "your@email.com";
        } else {
          studentFields.classList.add('hidden');
          teacherNotice.classList.remove('hidden');
          teacherEmailHint.classList.remove('hidden');

          // –î–µ–ª–∞–µ–º –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π
          studentClassNumber.required = false;
          studentClassLetter.required = false;

          // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É email –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π
          emailInput.placeholder = "your@schmos444.ru";
        }
      });

      // –¢–∞–∫–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–ª–∏–∫ –ø–æ –≤—Å–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ
      card.addEventListener('click', function(e) {
        if (e.target.type !== 'radio') {
          radio.checked = true;
          radio.dispatchEvent(new Event('change'));
        }
      });
    });

    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
    form.addEventListener('submit', function(e) {
      const btnText = submitBtn.querySelector('.btn-text');
      const btnLoading = submitBtn.querySelector('.btn-loading');

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      btnText.style.display = 'none';
      btnLoading.style.display = 'inline';
      submitBtn.disabled = true;

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–∞ —Ä–æ–ª—å
      const selectedRole = form.querySelector('input[name="role"]:checked');
      if (!selectedRole) {
        e.preventDefault();
        btnText.style.display = 'inline';
        btnLoading.style.display = 'none';
        submitBtn.disabled = false;
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å (–£—á–µ–Ω–∏–∫ –∏–ª–∏ –£—á–∏—Ç–µ–ª—å)');
        return;
      }

      // –î–ª—è —É—á–∏—Ç–µ–ª–µ–π –ø—Ä–æ–≤–µ—Ä—è–µ–º email
      if (selectedRole.value === 'teacher') {
        const email = emailInput.value.trim();
        if (!email.endsWith('@schmos444.ru')) {
          e.preventDefault();
          btnText.style.display = 'inline';
          btnLoading.style.display = 'none';
          submitBtn.disabled = false;
          alert('–î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—á–∏—Ç–µ–ª–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∫–æ–ª—å–Ω—ã–π email —Å –¥–æ–º–µ–Ω–æ–º @schmos444.ru');
          emailInput.focus();
          return;
        }
      }

      // –î–ª—è —É—á–µ–Ω–∏–∫–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∫–ª–∞—Å—Å–∞
      if (selectedRole.value === 'student') {
        if (!studentClassNumber.value.trim() || !studentClassLetter.value.trim()) {
          e.preventDefault();
          btnText.style.display = 'inline';
          btnLoading.style.display = 'none';
          submitBtn.disabled = false;
          alert('–î–ª—è —É—á–µ–Ω–∏–∫–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä –∏ –±—É–∫–≤—É –∫–ª–∞—Å—Å–∞');
          return;
        }
      }

      // –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
      const requiredFields = form.querySelectorAll('[required]');
      let isValid = true;
      let firstErrorField = null;

      requiredFields.forEach(field => {
        if (!field.value.trim() && field.type !== 'radio' && field.type !== 'checkbox') {
          isValid = false;
          field.classList.add('error-field');
          if (!firstErrorField) firstErrorField = field;
        } else if (field.type === 'checkbox' && !field.checked) {
          isValid = false;
        }
      });

      if (!isValid) {
        e.preventDefault();
        btnText.style.display = 'inline';
        btnLoading.style.display = 'none';
        submitBtn.disabled = false;

        if (firstErrorField) {
          firstErrorField.focus();
        }

        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.');
      }
    });

    // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–µ—Ä–≤–æ–µ –ø–æ–ª–µ
    const firstInput = form.querySelector('input:not([type="radio"]):not([type="checkbox"]):not([type="hidden"])');
    if (firstInput) {
      firstInput.focus();
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    const initialRole = form.querySelector('input[name="role"]:checked');
    if (initialRole && initialRole.value === 'teacher') {
      teacherNotice.classList.remove('hidden');
      teacherEmailHint.classList.remove('hidden');
      emailInput.placeholder = "your@schmos444.ru";
    }
  });
  </script>
</body>
</html>
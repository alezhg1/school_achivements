[file name]: register.html
[file content begin]
{% extends 'base.html' %}
{% block title %}–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è - –ú–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 444{% endblock %}

{% block content %}
<div class="auth-page">
  <div class="auth-container">
    
    <!-- –õ–µ–≤—ã–π –±–ª–æ–∫ - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="auth-info-card">
      <div class="auth-header">
        <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
        <div class="platform-icon">üéØ</div>
        <p class="platform-title">–ú–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 444</p>
      </div>

      <!-- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ -->
      <div class="brief-description">
        <p>–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</p>
      </div>

      <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ –≤—Ö–æ–¥ -->
      <div class="auth-switch">
        <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç?</p>
        <a href="{% url 'login' %}" class="switch-link">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</a>
      </div>
    </div>

    <!-- –ü—Ä–∞–≤—ã–π –±–ª–æ–∫ - –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div class="auth-form-card">
      <form method="post" class="auth-form" id="registerForm" novalidate>
        {% csrf_token %}

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π -->
        <div class="teacher-notice hidden" id="teacherNotice">
          <div class="notice-header">
            <span class="notice-icon">üë®‚Äçüè´</span>
            <div>
              <strong>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—á–∏—Ç–µ–ª—è</strong>
              <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∫–æ–ª—å–Ω—ã–π email @schmos444.ru</p>
            </div>
          </div>
        </div>

        <!-- –í—ã–≤–æ–¥ –æ–±—â–∏—Ö –æ—à–∏–±–æ–∫ -->
        {% if form.non_field_errors %}
          <div class="alert alert-error">
            {% for error in form.non_field_errors %}
              {{ error }}
            {% endfor %}
          </div>
        {% endif %}

        <!-- –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div class="form-section">
          <h3>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å *</h3>
          <div class="role-selection">
            <label class="role-card {% if form.role.value == 'student' or not form.role.value %}active{% endif %}">
              <input type="radio" name="role" value="student" {% if form.role.value == 'student' or not form.role.value %}checked{% endif %}>
              <div class="role-card-content">
                <span class="role-icon">üë®‚Äçüéì</span>
                <span class="role-title">–£—á–µ–Ω–∏–∫</span>
              </div>
            </label>
            
            <label class="role-card {% if form.role.value == 'teacher' %}active{% endif %}">
              <input type="radio" name="role" value="teacher" {% if form.role.value == 'teacher' %}checked{% endif %}>
              <div class="role-card-content">
                <span class="role-icon">üë®‚Äçüè´</span>
                <span class="role-title">–£—á–∏—Ç–µ–ª—å</span>
              </div>
            </label>
          </div>
          {% if form.role.errors %}
            <div class="field-errors">
              {% for error in form.role.errors %}
                <span class="error">{{ error }}</span>
              {% endfor %}
            </div>
          {% endif %}
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="form-section">
          <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="id_username">–õ–æ–≥–∏–Ω *</label>
              <input type="text" name="username" id="id_username" 
                     value="{{ form.username.value|default:'' }}" 
                     class="{% if form.username.errors %}error-field{% endif %}" 
                     placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω" required>
              {% if form.username.errors %}
                <div class="field-errors">
                  {% for error in form.username.errors %}
                    <span class="error">{{ error }}</span>
                  {% endfor %}
                </div>
              {% endif %}
            </div>

            <div class="form-group">
              <label for="id_email">Email *</label>
              <input type="email" name="email" id="id_email" 
                     value="{{ form.email.value|default:'' }}" 
                     class="{% if form.email.errors %}error-field{% endif %}" 
                     placeholder="your@email.com" required>
              {% if form.email.errors %}
                <div class="field-errors">
                  {% for error in form.email.errors %}
                    <span class="error">{{ error }}</span>
                  {% endfor %}
                </div>
              {% endif %}
              <div class="email-hint hidden" id="teacherEmailHint">
                <small>–î–ª—è —É—á–∏—Ç–µ–ª–µ–π: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ @schmos444.ru</small>
              </div>
            </div>

            <div class="form-group">
              <label for="id_first_name">–ò–º—è</label>
              <input type="text" name="first_name" id="id_first_name" 
                     value="{{ form.first_name.value|default:'' }}" 
                     placeholder="–í–∞—à–µ –∏–º—è">
            </div>

            <div class="form-group">
              <label for="id_last_name">–§–∞–º–∏–ª–∏—è</label>
              <input type="text" name="last_name" id="id_last_name" 
                     value="{{ form.last_name.value|default:'' }}" 
                     placeholder="–í–∞—à–∞ —Ñ–∞–º–∏–ª–∏—è">
            </div>
          </div>
        </div>

        <!-- –ö–ª–∞—Å—Å (—Ç–æ–ª—å–∫–æ –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤) -->
        <div class="form-section student-fields {% if form.role.value == 'teacher' %}hidden{% endif %}" id="studentFields">
          <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∞—Å—Å–µ *</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="id_class_number">–ù–æ–º–µ—Ä –∫–ª–∞—Å—Å–∞</label>
              <input type="text" name="class_number" id="id_class_number" 
                     value="{{ form.class_number.value|default:'' }}" 
                     placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5" required>
            </div>
            
            <div class="form-group">
              <label for="id_class_letter">–ë—É–∫–≤–∞ –∫–ª–∞—Å—Å–∞</label>
              <input type="text" name="class_letter" id="id_class_letter" 
                     value="{{ form.class_letter.value|default:'' }}" 
                     placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê" required>
            </div>
          </div>
        </div>

        <!-- –ü–∞—Ä–æ–ª–∏ -->
        <div class="form-section">
          <h3>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="id_password1">–ü–∞—Ä–æ–ª—å *</label>
              <input type="password" name="password1" id="id_password1" 
                     class="{% if form.password1.errors %}error-field{% endif %}" 
                     placeholder="–ù–µ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤" required>
              {% if form.password1.errors %}
                <div class="field-errors">
                  {% for error in form.password1.errors %}
                    <span class="error">{{ error }}</span>
                  {% endfor %}
                </div>
              {% endif %}
            </div>
            
            <div class="form-group">
              <label for="id_password2">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å *</label>
              <input type="password" name="password2" id="id_password2" 
                     class="{% if form.password2.errors %}error-field{% endif %}" 
                     placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
              {% if form.password2.errors %}
                <div class="field-errors">
                  {% for error in form.password2.errors %}
                    <span class="error">{{ error }}</span>
                  {% endfor %}
                </div>
              {% endif %}
            </div>
          </div>
        </div>

        <!-- –°–æ–≥–ª–∞—à–µ–Ω–∏–µ -->
        <div class="form-section">
          <div class="checkbox-group">
            <input type="checkbox" name="accept_policy" 
                   id="id_accept_policy" 
                   {% if form.accept_policy.value %}checked{% endif %} required>
            <label for="id_accept_policy" class="checkbox-label">
              –Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å <a href="#" style="color: #007bff; text-decoration: none;">–ø–æ–ª–∏—Ç–∏–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</a> *
            </label>
            {% if form.accept_policy.errors %}
              <div class="field-errors">
                {% for error in form.accept_policy.errors %}
                  <span class="error">{{ error }}</span>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
        <button type="submit" class="btn-primary" id="submitBtn">
          <span class="btn-text">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</span>
          <span class="btn-loading" style="display: none;">‚è≥ –°–æ–∑–¥–∞–µ–º –∞–∫–∫–∞—É–Ω—Ç...</span>
        </button>

        <div class="auth-footer">
          –ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã? <a href="#">–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</a>
        </div>
      </form>
    </div>

  </div>
</div>

<style>
/* –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å —Ñ–æ–Ω–∞ */
html, body {
  background: white !important;
  margin: 0;
  padding: 0;
  min-height: 100vh;
  height: 100vh;
  overflow: hidden; /* –£–±–∏—Ä–∞–µ–º —Å–∫—Ä–æ–ª–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
}

/* –£–±–∏—Ä–∞–µ–º —á–µ—Ä–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã */
* {
  box-sizing: border-box;
}

.auth-page {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh; /* –ó–∞–Ω–∏–º–∞–µ–º –≤—Å—é –≤—ã—Å–æ—Ç—É —ç–∫—Ä–∞–Ω–∞ */
  width: 100%;
  padding: 20px;
  background: white;
  position: relative;
}

.auth-container {
  display: grid;
  grid-template-columns: 0.7fr 1.3fr;
  gap: 30px;
  max-width: 1000px;
  width: 100%;
  animation: fadeIn 0.5s ease;
  margin: 0 auto;
  align-self: center;
}

/* –õ–µ–≤—ã–π –±–ª–æ–∫ - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */
.auth-info-card {
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  border: 1px solid #dee2e6;
  color: #333;
  padding: 30px 25px;
  border-radius: 16px;
  display: flex;
  flex-direction: column;
  gap: 25px;
  text-align: center;
  height: auto;
  align-self: center;
}

.auth-header {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.auth-header h1 {
  font-size: 1.8rem;
  margin: 0;
  font-weight: 800;
  line-height: 1.2;
  color: #003366;
}

.platform-icon {
  font-size: 3rem;
  margin: 0 auto;
}

.platform-title {
  font-size: 1.2rem;
  font-weight: 600;
  color: #007bff;
  margin: 0;
}

/* –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ */
.brief-description {
  padding: 0;
}

.brief-description p {
  font-size: 0.9rem;
  color: #666;
  line-height: 1.5;
  margin: 0;
}

/* –°—Å—ã–ª–∫–∞ –Ω–∞ –≤—Ö–æ–¥ */
.auth-switch {
  margin-top: auto;
  padding-top: 20px;
  border-top: 1px solid #dee2e6;
}

.auth-switch p {
  color: #666;
  font-size: 0.85rem;
  margin: 0 0 10px 0;
}

.switch-link {
  display: inline-block;
  background: #007bff;
  color: white;
  padding: 10px 18px;
  border-radius: 8px;
  text-decoration: none;
  font-weight: 600;
  font-size: 0.85rem;
  transition: all 0.3s ease;
}

.switch-link:hover {
  background: #0056b3;
  transform: translateY(-2px);
}

/* –ü—Ä–∞–≤—ã–π –±–ª–æ–∫ - –§–æ—Ä–º–∞ */
.auth-form-card {
  background: white;
  padding: 35px 30px;
  border-radius: 16px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
  border: 1px solid #e9ecef;
  height: auto;
  align-self: center;
}

.auth-form {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π */
.teacher-notice {
  background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
  color: #0d47a1;
  padding: 12px 15px;
  border-radius: 10px;
  border: 1px solid #90caf9;
  margin-bottom: 15px;
}

.teacher-notice.hidden {
  display: none;
}

.notice-header {
  display: flex;
  align-items: center;
  gap: 10px;
}

.notice-icon {
  font-size: 1.3rem;
}

.notice-header div {
  flex: 1;
}

.notice-header strong {
  display: block;
  font-size: 0.9rem;
  margin-bottom: 3px;
}

.notice-header p {
  margin: 0;
  font-size: 0.8rem;
  opacity: 0.9;
}

/* –°–µ–∫—Ü–∏–∏ —Ñ–æ—Ä–º—ã */
.form-section {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.form-section h3 {
  color: #003366;
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
}

/* –í—ã–±–æ—Ä —Ä–æ–ª–∏ */
.role-selection {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}

.role-card {
  position: relative;
  cursor: pointer;
}

.role-card input[type="radio"] {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.role-card-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  padding: 18px 12px;
  border: 2px solid #e8f4ff;
  border-radius: 12px;
  background: white;
  transition: all 0.3s ease;
  text-align: center;
  height: 100%;
}

.role-card input[type="radio"]:checked + .role-card-content,
.role-card.active .role-card-content {
  background: #007bff;
  color: white;
  border-color: #007bff;
  box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
  transform: translateY(-2px);
}

.role-card:hover .role-card-content {
  border-color: #007bff;
  transform: translateY(-2px);
}

.role-icon {
  font-size: 1.7rem;
}

.role-title {
  font-weight: 600;
  font-size: 0.9rem;
}

/* –°–µ—Ç–∫–∞ —Ñ–æ—Ä–º—ã */
.form-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
}

.form-row {
  display: flex;
  gap: 15px;
}

.form-row .form-group {
  flex: 1;
}

/* –ì—Ä—É–ø–ø—ã —Ñ–æ—Ä–º—ã */
.form-group {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.form-group label {
  font-weight: 600;
  color: #003366;
  font-size: 0.85rem;
}

.auth-form input:not([type="checkbox"]),
.auth-form select {
  width: 100%;
  padding: 10px 14px;
  border: 2px solid #e8f4ff;
  border-radius: 8px;
  background: #f9fcff;
  font-size: 0.9rem;
  transition: all 0.3s ease;
  font-family: inherit;
}

.auth-form input:focus,
.auth-form select:focus {
  border-color: #007bff;
  box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
  outline: none;
  background: white;
}

.error-field {
  border-color: #dc3545 !important;
}

.email-hint small {
  color: #007bff;
  font-size: 0.75rem;
}

/* –ß–µ–∫–±–æ–∫—Å */
.checkbox-group {
  display: flex;
  align-items: flex-start;
  gap: 10px;
}

.checkbox-group input[type="checkbox"] {
  width: 16px;
  height: 16px;
  margin-top: 3px;
}

.checkbox-label {
  font-size: 0.85rem;
  color: #333;
  line-height: 1.4;
  cursor: pointer;
}

.checkbox-label a {
  color: #007bff;
  font-weight: 600;
}

/* –ö–Ω–æ–ø–∫–∞ */
.btn-primary {
  background: linear-gradient(135deg, #007bff, #0047b3);
  color: white;
  border: none;
  padding: 14px;
  font-weight: 600;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 0.95rem;
  margin-top: 10px;
  width: 100%;
}

.btn-primary:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(0, 123, 255, 0.3);
}

.btn-primary:disabled {
  opacity: 0.7;
  cursor: not-allowed;
  transform: none;
}

/* –û—à–∏–±–∫–∏ */
.alert {
  padding: 12px 15px;
  border-radius: 8px;
  margin-bottom: 15px;
}

.alert-error {
  background: #f8d7da;
  color: #721c24;
  border: 1px solid #f5c6cb;
}

.field-errors {
  margin-top: 4px;
}

.error {
  color: #dc3545;
  font-size: 0.75rem;
  display: block;
}

/* –§—É—Ç–µ—Ä —Ñ–æ—Ä–º—ã */
.auth-footer {
  text-align: center;
  margin-top: 15px;
  color: #666;
  font-size: 0.8rem;
}

.auth-footer a {
  color: #007bff;
  font-weight: 600;
  text-decoration: none;
}

.auth-footer a:hover {
  text-decoration: underline;
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* –£—Ç–∏–ª–∏—Ç—ã */
.hidden {
  display: none !important;
}

/* –£–±–∏—Ä–∞–µ–º –≤—Å–µ —Å–ª–µ–¥—ã —á–µ—Ä–Ω–æ–≥–æ —Ñ–æ–Ω–∞ */
:root {
  --color-background: white;
  --color-surface: white;
  --color-text: #333;
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
@media (max-width: 768px) {
  .auth-container {
    grid-template-columns: 1fr;
    gap: 20px;
  }

  .auth-info-card {
    padding: 25px 20px;
  }

  .auth-form-card {
    padding: 25px 20px;
  }

  .form-grid {
    grid-template-columns: 1fr;
    gap: 15px;
  }

  .form-row {
    flex-direction: column;
    gap: 15px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('registerForm');
  const submitBtn = document.getElementById('submitBtn');
  const roleCards = document.querySelectorAll('.role-card');
  const studentFields = document.getElementById('studentFields');
  const teacherNotice = document.getElementById('teacherNotice');
  const teacherEmailHint = document.getElementById('teacherEmailHint');
  const emailInput = document.getElementById('id_email');
  const studentClassNumber = document.getElementById('id_class_number');
  const studentClassLetter = document.getElementById('id_class_letter');

  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π
  roleCards.forEach(card => {
    const radio = card.querySelector('input[type="radio"]');

    radio.addEventListener('change', function() {
      // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å
      roleCards.forEach(c => c.classList.remove('active'));
      card.classList.add('active');

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª—è –∫–ª–∞—Å—Å–∞
      if (this.value === 'student') {
        studentFields.classList.remove('hidden');
        teacherNotice.classList.add('hidden');
        teacherEmailHint.classList.add('hidden');

        // –î–µ–ª–∞–µ–º –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤
        studentClassNumber.required = true;
        studentClassLetter.required = true;

        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É email
        emailInput.placeholder = "your@email.com";
      } else {
        studentFields.classList.add('hidden');
        teacherNotice.classList.remove('hidden');
        teacherEmailHint.classList.remove('hidden');

        // –î–µ–ª–∞–µ–º –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π
        studentClassNumber.required = false;
        studentClassLetter.required = false;

        // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É email –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π
        emailInput.placeholder = "your@schmos444.ru";
      }
    });

    // –¢–∞–∫–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–ª–∏–∫ –ø–æ –≤—Å–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ
    card.addEventListener('click', function(e) {
      if (e.target.type !== 'radio') {
        radio.checked = true;
        radio.dispatchEvent(new Event('change'));
      }
    });
  });

  // –í–∞–ª–∏–¥–∞—Ü–∏—è email –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
  emailInput.addEventListener('blur', function() {
    const selectedRole = form.querySelector('input[name="role"]:checked');
    if (selectedRole && selectedRole.value === 'teacher') {
      const email = this.value.trim();
      if (email && !email.endsWith('@schmos444.ru')) {
        this.classList.add('error-field');
        // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        let errorDiv = this.parentElement.querySelector('.email-error');
        if (!errorDiv) {
          errorDiv = document.createElement('div');
          errorDiv.className = 'field-errors email-error';
          this.parentElement.appendChild(errorDiv);
        }
        errorDiv.innerHTML = '<span class="error">–î–ª—è —É—á–∏—Ç–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∫–æ–ª—å–Ω—ã–π –¥–æ–º–µ–Ω @schmos444.ru</span>';
      } else {
        this.classList.remove('error-field');
        const errorDiv = this.parentElement.querySelector('.email-error');
        if (errorDiv) {
          errorDiv.remove();
        }
      }
    }
  });

  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
  form.addEventListener('submit', function(e) {
    const btnText = submitBtn.querySelector('.btn-text');
    const btnLoading = submitBtn.querySelector('.btn-loading');

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    btnText.style.display = 'none';
    btnLoading.style.display = 'inline';
    submitBtn.disabled = true;

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–∞ —Ä–æ–ª—å
    const selectedRole = form.querySelector('input[name="role"]:checked');
    if (!selectedRole) {
      e.preventDefault();
      btnText.style.display = 'inline';
      btnLoading.style.display = 'none';
      submitBtn.disabled = false;
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å (–£—á–µ–Ω–∏–∫ –∏–ª–∏ –£—á–∏—Ç–µ–ª—å)');
      return;
    }

    // –î–ª—è —É—á–∏—Ç–µ–ª–µ–π –ø—Ä–æ–≤–µ—Ä—è–µ–º email
    if (selectedRole.value === 'teacher') {
      const email = emailInput.value.trim();
      if (!email.endsWith('@schmos444.ru')) {
        e.preventDefault();
        btnText.style.display = 'inline';
        btnLoading.style.display = 'none';
        submitBtn.disabled = false;
        alert('–î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—á–∏—Ç–µ–ª–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∫–æ–ª—å–Ω—ã–π email —Å –¥–æ–º–µ–Ω–æ–º @schmos444.ru');
        emailInput.focus();
        return;
      }
    }

    // –î–ª—è —É—á–µ–Ω–∏–∫–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∫–ª–∞—Å—Å–∞
    if (selectedRole.value === 'student') {
      if (!studentClassNumber.value.trim() || !studentClassLetter.value.trim()) {
        e.preventDefault();
        btnText.style.display = 'inline';
        btnLoading.style.display = 'none';
        submitBtn.disabled = false;
        alert('–î–ª—è —É—á–µ–Ω–∏–∫–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä –∏ –±—É–∫–≤—É –∫–ª–∞—Å—Å–∞');
        return;
      }
    }

    // –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
    const requiredFields = form.querySelectorAll('[required]');
    let isValid = true;
    let firstErrorField = null;

    requiredFields.forEach(field => {
      if (!field.value.trim() && field.type !== 'radio' && field.type !== 'checkbox') {
        isValid = false;
        field.classList.add('error-field');
        if (!firstErrorField) firstErrorField = field;
      } else if (field.type === 'checkbox' && !field.checked) {
        isValid = false;
        field.parentElement.style.color = '#dc3545';
      } else {
        field.classList.remove('error-field');
        if (field.type === 'checkbox') {
          field.parentElement.style.color = '';
        }
      }
    });

    if (!isValid) {
      e.preventDefault();
      btnText.style.display = 'inline';
      btnLoading.style.display = 'none';
      submitBtn.disabled = false;

      if (firstErrorField) {
        firstErrorField.focus();
      }

      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.');
    }
  });

  // –°–Ω–∏–º–∞–µ–º –æ—à–∏–±–∫—É –ø—Ä–∏ –≤–≤–æ–¥–µ
  const inputs = form.querySelectorAll('input');
  inputs.forEach(input => {
    input.addEventListener('input', function() {
      if (this.value.trim()) {
        this.classList.remove('error-field');

        // –£–±–∏—Ä–∞–µ–º –æ—à–∏–±–∫–∏ email –ø—Ä–∏ –≤–≤–æ–¥–µ
        if (this.type === 'email') {
          const errorDiv = this.parentElement.querySelector('.email-error');
          if (errorDiv) {
            errorDiv.remove();
          }
        }
      }
    });

    input.addEventListener('change', function() {
      if (this.type === 'checkbox' && this.checked) {
        this.parentElement.style.color = '';
      }
    });
  });

  // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–µ—Ä–≤–æ–µ –ø–æ–ª–µ
  const firstInput = form.querySelector('input:not([type="radio"]):not([type="checkbox"]):not([type="hidden"])');
  if (firstInput) {
    firstInput.focus();
  }

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  const initialRole = form.querySelector('input[name="role"]:checked');
  if (initialRole && initialRole.value === 'teacher') {
    teacherNotice.classList.remove('hidden');
    teacherEmailHint.classList.remove('hidden');
    emailInput.placeholder = "your@schmos444.ru";
  }
});
</script>
{% endblock %}
[file content end]